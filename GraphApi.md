# List of my drives
# https://graph.microsoft.com/v1.0/me/drives
{
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#drives",
    "value": [
        {
            "createdDateTime": "2017-12-06T05:04:13Z",
            "description": "",
            "id": "b!-g9Ltuwr-kiBn1dvBvLa7mMR17PCMh1LoD-vXZNUfLWgIhPT2B52T4a1dxAXH3EK",
            "lastModifiedDateTime": "2021-10-15T18:28:44Z",
            "name": "OneDrive",
            "webUrl": "https://pdsb1-my.sharepoint.com/personal/mai_mostafa_peelsb_com/Documents",
            "driveType": "business",
            "createdBy": {
                "user": {
                    "displayName": "System Account"
                }
            },
            "lastModifiedBy": {
                "user": {
                    "displayName": "System Account"
                }
            },
            "owner": {
                "user": {
                    "email": "mai.mostafa@peelsb.com",
                    "id": "b835bc0c-459f-416a-9c96-3ab99ac67421",
                    "displayName": "Mostafa, Mai"
                }
            },
            "quota": {
                "deleted": 2702918,
                "remaining": 1091979673562,
                "state": "normal",
                "total": 1099511627776,
                "used": 7529251296
            }
        },
        {
            "createdDateTime": "2021-11-04T15:54:34Z",
            "description": "This library contains items that have been modified or deleted but must remain available due to eDiscovery holds. Items cannot be modified or removed.",
            "id": "b!-g9Ltuwr-kiBn1dvBvLa7mMR17PCMh1LoD-vXZNUfLWEMnt4hiA-SLMKquFUzMz1",
            "lastModifiedDateTime": "2022-05-06T15:32:42Z",
            "name": "OneDrive",
            "webUrl": "https://pdsb1-my.sharepoint.com/personal/mai_mostafa_peelsb_com/PreservationHoldLibrary",
            "driveType": "business",
            "createdBy": {
                "user": {
                    "displayName": "System Account"
                }
            },
            "lastModifiedBy": {
                "user": {
                    "displayName": "System Account"
                }
            },
            "owner": {
                "user": {
                    "email": "mai.mostafa@peelsb.com",
                    "id": "b835bc0c-459f-416a-9c96-3ab99ac67421",
                    "displayName": "Mostafa, Mai"
                }
            },
            "quota": {
                "deleted": 2702918,
                "remaining": 1091979673562,
                "state": "normal",
                "total": 1099511627776,
                "used": 7529251296
            }
        }
    ]



# Get followed items
# https://graph.microsoft.com/v1.0/me/drive/following
{
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users('b835bc0c-459f-416a-9c96-3ab99ac67421')/drive/following",
    "value": [
        {
            "description": "Test follow and unfollow document",
            "id": "01UY654J5FCNGM3HS63RAJVSAKXMOYCXXK",
            "lastModifiedDateTime": "2022-05-09T15:19:15Z",
            "name": "Test Graph API Follow unfollow.docx",
            "size": 10484,
            "webUrl": "https://pdsb1-my.sharepoint.com/personal/mai_mostafa_peelsb_com/_layouts/15/Doc.aspx?sourcedoc=%7BCD4C13A5-5E9E-40DC-9AC8-0ABB1D815EEA%7D&file=Test%20Graph%20API%20Follow%20unfollow.docx&action=default&mobileredirect=true&DefaultItemOpen=1",
            "followed": {
                "followedDateTime": "2022-05-09T15:20:08.091816Z"
            },
            "lastModifiedBy": {
                "user": {
                    "displayName": "Mostafa, Mai",
                    "email": "MAI.MOSTAFA@PEELSB.COM"
                }
            },
            "parentReference": {
                "driveId": "b!-g9Ltuwr-kiBn1dvBvLa7mMR17PCMh1LoD-vXZNUfLWgIhPT2B52T4a1dxAXH3EK"
            }
        },
        {
            "description": "PDSB Virtual Tutoring Logo and Branding ChallengeMrs. Krugâ€™s IBT BTT Class @ Meadowvale Secondary SchoolPlease submit your suggestion below for Mrs. Cunningham and the Team at PDSB to review:Student name (include first & last name)  and student numb",
            "id": "017S6PSJSRKNJYZA7MDFEZOMXOBCUAQET4",
            "lastModifiedDateTime": "2022-05-06T17:44:10Z",
            "name": "PDSB Virtual Tutoring Logo and Branding Challenge.docx",
            "size": 6701396,
            "webUrl": "https://pdsb1-my.sharepoint.com/personal/rachel_marshall_peelsb_com/_layouts/15/Doc.aspx?sourcedoc=%7B8C535351-EC83-4919-9732-EE08A808127C%7D&file=PDSB%20Virtual%20Tutoring%20Logo%20and%20Branding%20Challenge.docx&action=default&mobileredirect=true&DefaultItemOpen=1",
            "followed": {
                "followedDateTime": "2022-05-09T13:28:39.1300453Z"
            },
            "lastModifiedBy": {
                "user": {
                    "displayName": "Marshall, Rachel",
                    "email": "RACHEL.MARSHALL@PEELSB.COM"
                }
            },
            "parentReference": {
                "driveId": "b!AhcpfqmJ2U2eUBSBbyVOBgKvIkwhuGRLs-L9TQi6WzBb9Sh_JPm8R4976HdsuXZ4"
            }
        },
        {
            "description": "    bf4d82af-887a-4404-b543-42017417a5b5        f92bf067-bc19-489e-a556-7fe95f508720   Documents       c70391ea-0b10-4ee9-b2b4-006d3fcad0cd   Test OOB Quick Links  AllItems.aspx  Hello test test test test test test test  ByAuthor.aspx  Merged Calendar    ",
            "id": "01PUL6XG3GJ2YMCK22JJGKXQ2YOKONAEEG",
            "lastModifiedDateTime": "2021-07-14T14:14:21Z",
            "name": "Tiles Demo.aspx",
            "size": 275,
            "webUrl": "https://pdsb1.sharepoint.com/sites/ModernDemos/SitePages/Tiles%20Demo.aspx",
            "followed": {
                "followedDateTime": "2022-04-04T16:29:13.7280377Z"
            },
            "lastModifiedBy": {
                "user": {
                    "displayName": "Mostafa, Mai",
                    "email": "MAI.MOSTAFA@PEELSB.COM"
                }
            },
            "parentReference": {
                "driveId": "b!pLCLuZ-1UkuzfWwhhm1x9-6tek1sTbNGuay5p789jffrXcz1XkEkTY4on6WlTcNF"
            }
        }
    ]
}


# Get drive item
# https://graph.microsoft.com/v1.0/drives/b!pLCLuZ-1UkuzfWwhhm1x9-6tek1sTbNGuay5p789jffrXcz1XkEkTY4on6WlTcNF/items/01PUL6XG3GJ2YMCK22JJGKXQ2YOKONAEEG
# https://graph.microsoft.com/v1.0/drives/b!AhcpfqmJ2U2eUBSBbyVOBgKvIkwhuGRLs-L9TQi6WzBb9Sh_JPm8R4976HdsuXZ4/items/017S6PSJSRKNJYZA7MDFEZOMXOBCUAQET4


# Unfollow drive item (working) -> POST /drives/{drive-id}/items/{item-id}/unfollow
# https://graph.microsoft.com/v1.0/drives/b!AhcpfqmJ2U2eUBSBbyVOBgKvIkwhuGRLs-L9TQi6WzBb9Sh_JPm8R4976HdsuXZ4/items/017S6PSJSRKNJYZA7MDFEZOMXOBCUAQET4/unfollow

# follow drive item (working) -> POST /drives/{drive-id}/items/{item-id}/follow
# https://graph.microsoft.com/v1.0/drives/b!AhcpfqmJ2U2eUBSBbyVOBgKvIkwhuGRLs-L9TQi6WzBb9Sh_JPm8R4976HdsuXZ4/items/017S6PSJSRKNJYZA7MDFEZOMXOBCUAQET4/follow


# Another item not in a shared library - working :D
https://graph.microsoft.com/v1.0/drives/b!hrMpRXGzaEuiWCNINUERKxhSXiz_RMhAot3pNzEUkgYxHG6daur9RaoNZ98PsB-K/items/01NJ27LUMPZEF7TQSNLBHKC3ZOTPN2RO5R
https://graph.microsoft.com/v1.0/drives/b!hrMpRXGzaEuiWCNINUERKxhSXiz_RMhAot3pNzEUkgYxHG6daur9RaoNZ98PsB-K/items/01NJ27LUMPZEF7TQSNLBHKC3ZOTPN2RO5R/unfollow
# Not working
https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b/drive/items/63a6b022-5854-4331-b00c-c02f115d2dda 

# Notes - Get a driveItem resource
GET /drives/{drive-id}/items/{item-id} -> working
GET /drives/{drive-id}/root:/{item-path}
GET /groups/{group-id}/drive/items/{item-id}
GET /groups/{group-id}/drive/root:/{item-path}
GET /me/drive/items/{item-id} -> not working
GET /me/drive/root:/{item-path}
GET /sites/{site-id}/drive/items/{item-id}
GET /sites/{site-id}/drive/root:/{item-path}
GET /sites/{site-id}/lists/{list-id}/items/{item-id}/driveItem
GET /users/{user-id}/drive/items/{item-id} -> not working
GET /users/{user-id}/drive/root:/{item-path}

# Unfollow drive item
DELETE /me/drive/following/{item-id}
DELETE /users/{user-id}/drive/following/{item-id}
POST /me/drive/items/{item-id}/unfollow
POST /users/{user-id}/drive/items/{item-id}/unfollow


# Working for my drive 
# Get Item
GET https://graph.microsoft.com/v1.0/me/drive/items/01UY654J5FCNGM3HS63RAJVSAKXMOYCXXK
# Unfollow Item
POST https://graph.microsoft.com/v1.0/me/drive/items/01UY654J5FCNGM3HS63RAJVSAKXMOYCXXK/unfollow
# follow Item
POST https://graph.microsoft.com/v1.0/me/drive/items/01UY654J5FCNGM3HS63RAJVSAKXMOYCXXK/follow

# Important Notes
- The item has to exist in my-drive in order to use the item-id because it is related to my-drive-id
- Items that does not exist in my-drive, the drive-id has to be used with the item-id 
- To follow an item:
    - item-id and drive-id are needed
    - get site-id -> https://pdsb1.sharepoint.com/LDSS/SchoolSupport/_api/site/id
    - get drive-id of the document library -> https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b/drive


/sites/{site-id}/drive/items/{item-id}
https://graph.microsoft.com/v1.0/sites/pdsb1.sharepoint.com:/LDSS/SchoolSupport?$select=id
-> return: {hostname},{spsite.id},{spweb.id}
"id": "pdsb1.sharepoint.com,4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206"

https://pdsb1.sharepoint.com/LDSS/SchoolSupport/Forms1/Accumulation%20of%20French%20Instruction%20Form.pdf




https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206/lists/{list-id}/items/{item- id}/driveItem


Working!!
Get siteId & webId
    https://graph.microsoft.com/v1.0/sites/pdsb1.sharepoint.com:/LDSS/SchoolSupport?$select=id
Get driveId of the list
    https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206/lists/9d6e1c31-ea6a-45fd-aa0d-67df0fb01f8a/drive
Get itemId of the listItem
    https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206/lists/9d6e1c31-ea6a-45fd-aa0d-67df0fb01f8a/items/14/driveItem


# Required:
1- listId -> get from list item
2- listItemId -> get from list item
3- siteUrl -> get from list item
4- hostName -> pdsb1.sharepoint.com
5- siteId -> 4529b386-b371-4b68-a258-23483541112b
6- webId -> get from graph api 1st call -> https://graph.microsoft.com/v1.0/sites/<hostName>:/<webUrl>
7- driveId & driveItemId-> get from graph api 2nd call -> https://graph.microsoft.com/v1.0/sites/<siteId,webId>/lists/<listId>/items/14/driveItem


# STEP 1
# Request https://graph.microsoft.com/v1.0/sites/<hostName>:/<webUrl>
# Example Response: "id": "<hostName>,<siteId>,<webId>",
# Example https://graph.microsoft.com/v1.0/sites/pdsb1.sharepoint.com:/LDSS/SchoolSupport
# Example Response:
{
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#sites/$entity",
    "createdDateTime": "2020-03-06T19:10:20Z",
    "description": "",
    "id": "pdsb1.sharepoint.com,4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206",
    "lastModifiedDateTime": "2022-05-05T06:58:53Z",
    "name": "SchoolSupport",
    "webUrl": "https://pdsb1.sharepoint.com/LDSS/SchoolSupport",
    "displayName": "School Support",
    "parentReference": {
        "siteId": "pdsb1.sharepoint.com,4529b386-b371-4b68-a258-23483541112b,ba0ae9ee-52c5-48a2-a5cc-a3c5b7cbba15"
    }
}
# STEP 2
# Request https://graph.microsoft.com/v1.0/sites/<siteId,webId>/lists/<listId>/items/14/driveItem
# Example Response: parentReference > driveId & id --> driveId & itemId
# Example https://graph.microsoft.com/v1.0/sites/4529b386-b371-4b68-a258-23483541112b,2c5e5218-44ff-40c8-a2dd-e93731149206/lists/9d6e1c31-ea6a-45fd-aa0d-67df0fb01f8a/items/14/driveItem
y# Example Response:
{
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#sites('4529b386-b371-4b68-a258-23483541112b%2C2c5e5218-44ff-40c8-a2dd-e93731149206')/lists('9d6e1c31-ea6a-45fd-aa0d-67df0fb01f8a')/items('14')/driveItem/$entity",
    "@microsoft.graph.downloadUrl": "https://pdsb1.sharepoint.com/LDSS/SchoolSupport/_layouts/15/download.aspx?UniqueId=f90bc98f-4dc2-4e58-a16f-2e9bdba8bbb1&Translate=false&tempauth=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvcGRzYjEuc2hhcmVwb2ludC5jb21AYTQ5NDc0M2YtNzIwMS00OTRkLWE0NTItZjQ4YzUzODhjNGMwIiwiaXNzIjoiMDAwMDAwMDMtMDAwMC0wZmYxLWNlMDAtMDAwMDAwMDAwMDAwIiwibmJmIjoiMTY1MjExNjkyMSIsImV4cCI6IjE2NTIxMjA1MjEiLCJlbmRwb2ludHVybCI6IkM3NWNyL01MdGxCeHlxQUxORDdvZ1NsUFUyNmhVcUdpcENJWDN3Nkt4ODQ9IiwiZW5kcG9pbnR1cmxMZW5ndGgiOiIxMzUiLCJpc2xvb3BiYWNrIjoiVHJ1ZSIsImNpZCI6IlptRTJOalprTXpRdE1qY3paQzB5WlRWaExURXdPRGt0Tm1WbE1EWTRNemRoTkRBeiIsInZlciI6Imhhc2hlZHByb29mdG9rZW4iLCJzaXRlaWQiOiJORFV5T1dJek9EWXRZak0zTVMwMFlqWTRMV0V5TlRndE1qTTBPRE0xTkRFeE1USmkiLCJhcHBfZGlzcGxheW5hbWUiOiJHcmFwaCBFeHBsb3JlciIsImdpdmVuX25hbWUiOiJNYWkiLCJmYW1pbHlfbmFtZSI6Ik1vc3RhZmEiLCJzaWduaW5fc3RhdGUiOiJbXCJrbXNpXCIsXCJkdmNfZG1qZFwiXSIsImFwcGlkIjoiZGU4YmM4YjUtZDlmOS00OGIxLWE4YWQtYjc0OGRhNzI1MDY0IiwidGlkIjoiYTQ5NDc0M2YtNzIwMS00OTRkLWE0NTItZjQ4YzUzODhjNGMwIiwidXBuIjoibWFpLm1vc3RhZmFAcGVlbHNiLmNvbSIsInB1aWQiOiIxMDAzM0ZGRkE2M0Y3MTlEIiwiY2FjaGVrZXkiOiIwaC5mfG1lbWJlcnNoaXB8MTAwMzNmZmZhNjNmNzE5ZEBsaXZlLmNvbSIsInNjcCI6ImFsbGZpbGVzLndyaXRlIGdyb3VwLnJlYWQgZ3JvdXAud3JpdGUgYWxsc2l0ZXMud3JpdGUgYWxscHJvZmlsZXMucmVhZCBhbGxwcm9maWxlcy53cml0ZSIsInR0IjoiMiIsInVzZVBlcnNpc3RlbnRDb29raWUiOm51bGwsImlwYWRkciI6IjIwLjE5MC4xMzkuMTcxIn0.V3VUekNReFpFZHUxYWI4L3dUcThzRlZoTm5SODdLSTg4SkZkWGlXR3Jmbz0&ApiVersion=2.0",
    "createdDateTime": "2019-02-20T14:54:33Z",
    "eTag": "\"{F90BC98F-4DC2-4E58-A16F-2E9BDBA8BBB1},16\"",
    "id": "01NJ27LUMPZEF7TQSNLBHKC3ZOTPN2RO5R",
    "lastModifiedDateTime": "2022-04-13T13:36:16Z",
    "name": "Accumulation of French Instruction Form.pdf",
    "webUrl": "https://pdsb1.sharepoint.com/LDSS/SchoolSupport/Forms1/Accumulation%20of%20French%20Instruction%20Form.pdf",
    "cTag": "\"c:{F90BC98F-4DC2-4E58-A16F-2E9BDBA8BBB1},1\"",
    "size": 12986,
    "createdBy": {
        "user": {
            "email": "cynthia.gaston@peelsb.com",
            "id": "838c174a-d71a-430f-afb5-4572c09ad76d",
            "displayName": "Gaston, Cynthia"
        }
    },
    "lastModifiedBy": {
        "user": {
            "email": "Learn11@peelsb.com",
            "id": "cc19ffad-1c21-45a2-87c1-f144c8bcc33d",
            "displayName": "Learn11"
        }
    },
    "parentReference": {
        "driveType": "documentLibrary",
        "driveId": "b!hrMpRXGzaEuiWCNINUERKxhSXiz_RMhAot3pNzEUkgYxHG6daur9RaoNZ98PsB-K",
        "id": "01NJ27LUN6Y2GOVW7725BZO354PWSELRRZ",
        "path": "/drives/b!hrMpRXGzaEuiWCNINUERKxhSXiz_RMhAot3pNzEUkgYxHG6daur9RaoNZ98PsB-K/root:"
    },
    "file": {
        "mimeType": "application/pdf",
        "hashes": {
            "quickXorHash": "a7uCkfWpRn/+Ei/KCHv0Ga27eLk="
        }
    },
    "fileSystemInfo": {
        "createdDateTime": "2019-02-20T14:54:33Z",
        "lastModifiedDateTime": "2022-04-13T13:36:16Z"
    }



Wow!
https://www.techmikael.com/2021/01/microsoft-graph-encoding-and-decoding.html




# Console.log() shortcut
clg for console.log(object);
clo for console.log('object :', object);